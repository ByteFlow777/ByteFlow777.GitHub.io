<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" href=https://ileonli.github.io/favicon.ico><link rel=stylesheet href=/css/style.min.css><link rel=canonical href=https://ileonli.github.io/posts/java/jdbc/><title>Java 数据库连接 (JDBC)</title></head><body><header id=banner></header><main id=content><article><header id=post-header><h1>Java 数据库连接 (JDBC)</h1><div><time>2023-09-19</time></div></header><blockquote><p>翻译：https://docs.oracle.com/javase/tutorial/jdbc/basics/index.html</p></blockquote><h1 id=使用-jdbc-处理-sql-语句>使用 JDBC 处理 SQL 语句</h1><p>一般来说，使用 JDBC 处理 SQL 语句需要以下步骤：</p><ol><li>建立连接。</li><li>创建 <code>Statement</code>。</li><li>执行查询。</li><li>处理 <code>ResultSet</code> 对象。</li><li>关闭连接。</li></ol><p>本页面使用 <a href=https://docs.oracle.com/javase/tutorial/jdbc/basics/examples/JDBCTutorial/src/com/oracle/tutorial/jdbc/CoffeesTable.java>CoffeesTable.viewTable</a> 教程示例中的方法来演示这些步骤。该方法输出 <code>COFFEES</code> 表的内容。本教程稍后将更详细地讨论此方法：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>viewTable</span><span class=o>(</span><span class=n>Connection</span> <span class=n>con</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>SQLException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>query</span> <span class=o>=</span> <span class=s>&#34;select COF_NAME, SUP_ID, PRICE, SALES, TOTAL from COFFEES&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>(</span><span class=n>Statement</span> <span class=n>stmt</span> <span class=o>=</span> <span class=n>con</span><span class=o>.</span><span class=na>createStatement</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>stmt</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=n>query</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=n>rs</span><span class=o>.</span><span class=na>next</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>            <span class=n>String</span> <span class=n>coffeeName</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=s>&#34;COF_NAME&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>supplierID</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getInt</span><span class=o>(</span><span class=s>&#34;SUP_ID&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=kt>float</span> <span class=n>price</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getFloat</span><span class=o>(</span><span class=s>&#34;PRICE&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>sales</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getInt</span><span class=o>(</span><span class=s>&#34;SALES&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>total</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getInt</span><span class=o>(</span><span class=s>&#34;TOTAL&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>coffeeName</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>supplierID</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>price</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                            <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>sales</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>total</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>SQLException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>JDBCTutorialUtilities</span><span class=o>.</span><span class=na>printSQLException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><h2 id=建立连接>建立连接</h2><p>首先，需要要使用的数据源建立连接。数据源可以是 DBMS、传统（legacy）文件系统或其他具有相应 JDBC 驱动程序的数据源。此连接由连接对象表示。</p><h2 id=创建-statement>创建 Statement</h2><p><code>Statement</code> 是表示 SQL 语句的接口。执行 <code>Statement</code> 对象会生成 <code>ResultSet</code> 对象，这是一个代表数据库结果集的数据表。创建 <code>Statement</code> 对象需要使用 <code>Connection</code> 对象。</p><p>例如：<code>CoffeesTable.viewTable</code> 使用以下代码创建 <code>Statement</code> 对象：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=n>stmt</span> <span class=o>=</span> <span class=n>con</span><span class=o>.</span><span class=na>createStatement</span><span class=o>();</span>
</span></span></code></pre></div><p>有三种不同的 <code>Statement</code>：</p><ul><li><code>Statement</code>：用于实现简单的且没有参数的 SQL 语句。</li><li><code>PreparedStatement</code>：扩展的 <code>Statement</code>，预编译 SQL 语句，该 SQL 可能包含输入参数。</li><li><code>CallableStatement</code>：扩展的 <code>PreparedStatement</code>，用于执行可能包含输入和输出参数的存储过程。</li></ul><h2 id=执行查询>执行查询</h2><p>为了执行查询，需要调用 <code>Statement</code> 方法：</p><ul><li><code>execute</code>：如果查询返回的第一个对象是一个 <code>ResultSet</code> 对象，则返回 <code>true</code>。如果查询可能返回一个或多个 <code>ResultSet</code> 对象，则使用该方法。通过重复调用 <code>Statement.getResultSet</code> 来读取查询返回的 <code>ResultSet</code> 对象。</li><li><code>executeQuery</code>：返回一个<code>ResultSet</code> 对象。</li><li><code>executeUpdate</code>：返回一个整数，表示被 SQL 语句影响的行数。如果您使用 <code>INSERT</code>、<code>DELETE</code> 或 <code>UPDATE</code> 等SQL 语句，请使用此方法。</li></ul><p>例如：<code>CoffeesTable.viewTable</code> 使用以下代码执行 <code>Statement</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>stmt</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=n>query</span><span class=o>);</span>
</span></span></code></pre></div><h2 id=处理-resultset-对象>处理 <code>ResultSet</code> 对象</h2><p>您可以通过游标（cursor）访问 <code>ResultSet</code> 对象中的数据。请注意，该游标不是数据库游标。该游标是一个指针，指向 <code>ResultSet</code> 对象中的一行数据。最初，光标位于第一行之前。您可以调用 <code>ResultSet</code> 对象中定义的各种方法来移动光标。</p><p>例如，<code>CoffeesTable.viewTable</code> 重复调用 <code>ResultSet.next</code> 方法将光标向前移动一行。每次调用<code>next</code> 时，该方法都会输出光标当前所在行的数据：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl>    <span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>stmt</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=n>query</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=o>(</span><span class=n>rs</span><span class=o>.</span><span class=na>next</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>coffeeName</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=s>&#34;COF_NAME&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>supplierID</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getInt</span><span class=o>(</span><span class=s>&#34;SUP_ID&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>float</span> <span class=n>price</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getFloat</span><span class=o>(</span><span class=s>&#34;PRICE&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>sales</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getInt</span><span class=o>(</span><span class=s>&#34;SALES&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>total</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getInt</span><span class=o>(</span><span class=s>&#34;TOTAL&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>coffeeName</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>supplierID</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>price</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                            <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>sales</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>total</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ..
</span></span></span></code></pre></div><h2 id=关闭连接>关闭连接</h2><p>当使用完 <code>Connection</code>、<code>Statement</code> 或 <code>ResultSet</code> 对象后，调用其 <code>close</code> 方法立即释放正在使用的资源。</p><p>此外，使用 try-with-resources 语句自动关闭 <code>Connection</code>、<code>Statement</code> 和 <code>ResultSet</code> 对象，无论是否抛出 <code>SQLException</code> 异常（当 JDBC 在与数据源交互期间遇到错误时，它会抛出 <code>SQLException</code>）。自动资源语句由 try 语句和一个或多个声明的资源组成。例如 <code>CoffeesTable.viewTable</code> 方法自动关闭其 <code>Statement</code> 对象，如下所示：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>viewTable</span><span class=o>(</span><span class=n>Connection</span> <span class=n>con</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>SQLException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=n>String</span> <span class=n>query</span> <span class=o>=</span> <span class=s>&#34;select COF_NAME, SUP_ID, PRICE, SALES, TOTAL from COFFEES&#34;</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=k>try</span> <span class=o>(</span><span class=n>Statement</span> <span class=n>stmt</span> <span class=o>=</span> <span class=n>con</span><span class=o>.</span><span class=na>createStatement</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ResultSet</span> <span class=n>rs</span> <span class=o>=</span> <span class=n>stmt</span><span class=o>.</span><span class=na>executeQuery</span><span class=o>(</span><span class=n>query</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=k>while</span> <span class=o>(</span><span class=n>rs</span><span class=o>.</span><span class=na>next</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>String</span> <span class=n>coffeeName</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getString</span><span class=o>(</span><span class=s>&#34;COF_NAME&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>supplierID</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getInt</span><span class=o>(</span><span class=s>&#34;SUP_ID&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>float</span> <span class=n>price</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getFloat</span><span class=o>(</span><span class=s>&#34;PRICE&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>sales</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getInt</span><span class=o>(</span><span class=s>&#34;SALES&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>total</span> <span class=o>=</span> <span class=n>rs</span><span class=o>.</span><span class=na>getInt</span><span class=o>(</span><span class=s>&#34;TOTAL&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=n>coffeeName</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>supplierID</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>price</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                            <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>sales</span> <span class=o>+</span> <span class=s>&#34;, &#34;</span> <span class=o>+</span> <span class=n>total</span><span class=o>);</span>
</span></span><span class=line><span class=cl>        <span class=o>}</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>catch</span> <span class=o>(</span><span class=n>SQLException</span> <span class=n>e</span><span class=o>)</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>JDBCTutorialUtilities</span><span class=o>.</span><span class=na>printSQLException</span><span class=o>(</span><span class=n>e</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p>下面是一个 try-with-resources 语句，它声明了一个资源 <code>stmt</code>，当 try 块终止时，该资源将自动关闭：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=k>try</span> <span class=o>(</span><span class=n>Statement</span> <span class=n>stmt</span> <span class=o>=</span> <span class=n>con</span><span class=o>.</span><span class=na>createStatement</span><span class=o>())</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=o>}</span>
</span></span></code></pre></div><hr><h1 id=建立连接-1>建立连接</h1><p>首先，你需要与你使用的数据源建立连接。数据源可以是 DBMS、传统（legacy）文件系统或具其他具有相应 JDBC 驱动程序的数据源。通常，一个 JDBC 应用使用下面两个类中的一个连接到目标数据源：</p><ul><li><code>DriverManager</code>：通过这个完全实现的类可将应用程序连接到数据源，数据源由数据库 URL 指定。当此类第一次尝试建立连接时，会自动加载类路径下所有的 JDBC 4.0 驱动。请注意，你的程序必须手动加载 4.0 版本之前的 JDBC 驱动。</li><li><code>DataSource</code>：该接口优于 <code>DriverManager</code>，对于底层数据源的细节对应用透明。设置 <code>DataSource</code> 对象的属性以使其代表特定的数据源。</li></ul><h2 id=使用-drivermanager-类>使用 DriverManager 类</h2><p>使用 <code>DeriverManager</code> 类连接到 DBMS 涉及调用 <code>DriverManager.getConnection</code> 方法。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-Java data-lang=Java><span class=line><span class=cl><span class=kd>public</span> <span class=n>Connection</span> <span class=nf>getConnection</span><span class=o>()</span> <span class=kd>throws</span> <span class=n>SQLException</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>Connection</span> <span class=n>conn</span> <span class=o>=</span> <span class=kc>null</span><span class=o>;</span>
</span></span><span class=line><span class=cl>    <span class=n>Properties</span> <span class=n>connectionProps</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Properties</span><span class=o>();</span>
</span></span><span class=line><span class=cl>    <span class=n>connectionProps</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;user&#34;</span><span class=o>,</span> <span class=k>this</span><span class=o>.</span><span class=na>userName</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=n>connectionProps</span><span class=o>.</span><span class=na>put</span><span class=o>(</span><span class=s>&#34;password&#34;</span><span class=o>,</span> <span class=k>this</span><span class=o>.</span><span class=na>password</span><span class=o>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>(</span><span class=k>this</span><span class=o>.</span><span class=na>dbms</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;mysql&#34;</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span> <span class=o>=</span> <span class=n>DriverManager</span><span class=o>.</span><span class=na>getConnection</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                   <span class=s>&#34;jdbc:&#34;</span> <span class=o>+</span> <span class=k>this</span><span class=o>.</span><span class=na>dbms</span> <span class=o>+</span> <span class=s>&#34;://&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                   <span class=k>this</span><span class=o>.</span><span class=na>serverName</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                   <span class=s>&#34;:&#34;</span> <span class=o>+</span> <span class=k>this</span><span class=o>.</span><span class=na>portNumber</span> <span class=o>+</span> <span class=s>&#34;/&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                   <span class=n>connectionProps</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span> <span class=k>else</span> <span class=k>if</span> <span class=o>(</span><span class=k>this</span><span class=o>.</span><span class=na>dbms</span><span class=o>.</span><span class=na>equals</span><span class=o>(</span><span class=s>&#34;derby&#34;</span><span class=o>))</span> <span class=o>{</span>
</span></span><span class=line><span class=cl>        <span class=n>conn</span> <span class=o>=</span> <span class=n>DriverManager</span><span class=o>.</span><span class=na>getConnection</span><span class=o>(</span>
</span></span><span class=line><span class=cl>                   <span class=s>&#34;jdbc:&#34;</span> <span class=o>+</span> <span class=k>this</span><span class=o>.</span><span class=na>dbms</span> <span class=o>+</span> <span class=s>&#34;:&#34;</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                   <span class=k>this</span><span class=o>.</span><span class=na>dbName</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>                   <span class=s>&#34;;create=true&#34;</span><span class=o>,</span>
</span></span><span class=line><span class=cl>                   <span class=n>connectionProps</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=o>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Connected to database&#34;</span><span class=o>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>conn</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></div><p><code>DriverManager.getConnection</code> 方法建立了数据库连接。此方法需要数据库 URL，取决于你的 DBMS。下边是一些数据库 URL 的例子：</p><ol><li>MySQL：<code>jdbc:mysql://localhost:3306/</code>，其中 <code>localhost</code> 是托管数据库服务器的名称，3306 是端口。</li><li>Java DB：<code>jdbc:derby:testdb;create=true</code>，其中 <code>testdb</code> 是要连接的数据库名称，<code>create=true</code> 指明 DBMS 创建数据库。<blockquote><p>注意：此 URL 可与 Java DB 嵌入式驱动程序建立数据库连接。Java DB 还包括一个网络客户端驱动程序，它使用不同的 URL。</p></blockquote></li></ol><p>此方法使用 <code>Properties</code> 对象指定访问 DBMS 所需的用户名和密码。</p><p>注意：</p><ul><li>通常，在数据库 URL 中，你还需要指定想要连接的现存数据库名称。例如：<code>jdbc:mysql://localhost:3306/mysql</code> 展示了连接到数据库名为 <code>mysql</code> 的 MySQL 数据库 URL。本教程中的示例使用的 URL 未指定特定数据库，因为示例创建了一个新数据库。</li><li>在 JDBC 之前的版本中，为获得连接，你首先需要调用 <code>Class.forName</code> 方法初始化 JDBC 驱动。此方法需要类型为 <code>java.sql.Driver</code> 的对象。每个 JDBC 驱动都包含一个或多个实现 <code>java.sql.Driver</code> 接口的类。Java DB 的驱动是 <code>org.apache.derby.jdbc.EmbeddedDriver</code> 和 <code>org.apache.derby.jdbc.ClientDriver</code>。MySQL Connector/J 之一是 <code>com.mysql.cj.jdbc.Driver</code>。查阅你使用的 DBMS 驱动的文档来获取实现 <code>java.sql.Driver</code> 接口的类名。在类路径找到的 JDBC 4.0 驱动会被自动加载。（然而，你需要通过 <code>Class.forName</code> 方法手动加载 JDBC 4.0 之前的所有驱动）。</li></ul><p>此方法返回 <code>Connection</code> 对象，此对象表示与 DBMS 或指定数据库的连接。通过此对象查询数据库。</p><h2 id=指定数据库连接-url>指定数据库连接 URL</h2><p>数据库连接 URL 是 DBMS JDBC 驱动连接到数据库所使用的字符串。它可以包含一些信息，如搜索数据库的位置、要连接的数据库名称以及配置属性等。数据库连接 URL 的语法由 DBMS 规定。</p><h3 id=java-db-数据库连接-url>Java DB 数据库连接 URL</h3><p>下边是 Java DB 数据库连接 URL 的语法：</p><pre tabindex=0><code>jdbc:derby:[subsubprotocol:][databaseName][;attribute=value]*
</code></pre><ul><li><code>subsubprotocol</code>：指定 Java DB 应在何处搜索数据库，在目录、内存、类路径或者 JAR 文件中。该部分通常被省略。</li><li><code>databaseName</code> 是应该连接到的数据库名称。</li><li><code>attribute=value</code> 代表是可选的，以分号分割的符号列表。这些属性允许你指导 Java DB 执行各种任务：包括：<ul><li>创建在连接 URL 指定的数据库。</li><li>加密在连接 URL 指定的数据库。</li><li>指定存储日志和追踪信息的目录。</li><li>指定连接到数据库的用户名和密码。</li></ul></li></ul><h3 id=mysql-connectorj-数据库-url>MySQL Connector/J 数据库 URL</h3><p>下边是 MySQL Connector/J 数据库连接 URL 的语法：</p><pre tabindex=0><code>jdbc:mysql://[host][,failoverhost...]
    [:port]/[database]
    [?propertyName1][=propertyValue1]
    [&amp;propertyName2][=propertyValue2]...
</code></pre><ul><li><code>host:port</code>：是数据库所在计算机的主机名和端口号。如果未指定，默认的 <code>host</code> 和 <code>port</code> 分别是 127.0.0.1 和 3306。</li><li><code>database</code>：是数据库连接的名称。如果未指定，建立连接时不使用任何数据库。</li><li><code>failover</code>：是备用数据库的名称（MySQL Connector/J 支持故障转移）。</li><li><code>propertyName=propertyValue</code>：是可选的，使用 & 分割的属性列表。这些属性允许你指导 MySQL Connector/J 执行各种任务。</li></ul><hr><h1 id=使用-datasource-对象连接>使用 <code>DataSource</code> 对象连接</h1><p>此节覆盖 <code>DataSource</code> 对象，使用此对象是连接数据源的优先方法。</p><h2 id=使用-datasource-对象获得连接>使用 <code>DataSource</code> 对象获得连接</h2><hr><h1 id=处理-sql-异常>处理 SQL 异常</h1><h2 id=sqlexception-概述><code>SQLException</code> 概述</h2><p>当 JDBC 与数据库交互遇到错误时，它抛出一个 <code>SQLException</code> 实例而不是 <code>Exception</code>。此上下文中的数据源表示 <code>Connection</code> 对象所连接的数据库。<code>SQLException</code> 实例包含以下信息，可以帮助你推断造成错误的原因：</p><ul><li>错误的描述。通过调用 <code>SQLException.getMessage</code> 方法获取 <code>String</code> 类型的描述。</li><li><code>SQLState</code> 代码。这些代码及其含义已由 ISO/ANSI 和 Open Group (X/Open) 标准化，尽管有些代码已保留给数据库供应商自行定义。该 <code>String</code> 对象由五个字母数字字符组成。通过调用 <code>SQLException.getSQLState</code> 方法获取此代码。</li><li>引起此异常的原因。<code>SQLException</code> 实例可能具有因果关系，该关系由导致抛出 <code>SQLException</code> 实例的一个或多个 <code>Throwable</code> 对象组成。要获取此原因链，递归地调用 <code>SQLException.getCause</code> 方法直到返回 <code>null</code> 值。</li><li>对任何链式（chained）异常的引用。如果发生多个错误，则通过该链引用异常。通过对引发的异常调用方法 <code>SQLException.getNextException</code> 来获取异常。</li></ul><h2 id=获取异常>获取异常</h2><hr><h1 id=使用-preparedstatement>使用 <code>PreparedStatement</code></h1><h2 id=preparedstatement-概述><code>PreparedStatement</code> 概述</h2><p>在某些情况下，使用 <code>PreparedStatement</code> 对象向数据库发送 SQL 语句更加方便。这种特殊类型的语句派生自更通用的 <code>Statement</code> 类。</p></article></main><footer id=footer></footer></body></html>